<section>
  <mat-card>
    <div class="video-container" #videoRef></div>
    <footer>
      <button mat-fab color="primary" (click)="toggleAudio()">
        <mat-icon>
          {{ form.audioEnabled ? 'mic' : 'mic_off' }}
        </mat-icon>
      </button>
      <button mat-fab color="primary" (click)="toggleVideo()">
        <mat-icon>
          {{ form.videoEnabled ? 'videocam' : 'videocam_off' }}
        </mat-icon>
      </button>
    </footer>
  </mat-card>
</section>

<form [formGroup]="form">
  <mat-card *ngIf="facade.devices$ | async as devices">
    <div>
      <!-- <mat-tab-group>
        <mat-tab label="Dispositivos">
          <ng-template matTabContent>
            <mat-card-content>
              <section formGroupName="audio">
                <peer-devices
                  formControlName="deviceId"
                  kind="audioinput"
                  label="Entrada de áudio"
                  (selectionChange)="onAudioChange($event)"
                ></peer-devices>
              </section>
              <section formGroupName="video">
                <peer-devices
                  formControlName="deviceId"
                  kind="videoinput"
                  label="Entrada de vídeo"
                  (selectionChange)="onVideoChange($event)"
                ></peer-devices>
              </section>
              <section formGroupName="speaker">
                <peer-devices
                  formControlName="deviceId"
                  kind="audiooutput"
                  label="Saída de áudio"
                  [disable]="!facade.setSinkIdSupported"
                  (selectionChange)="onSpeakerChange($event)"
                ></peer-devices>
              </section>
            </mat-card-content>
          </ng-template>
        </mat-tab>
        <mat-tab label="Configurações">
          <ng-template matTabContent>
            <mat-card-content>
              <section formGroupName="video">
                <mat-form-field>
                  <mat-label>Resolução da câmera</mat-label>

                  <mat-select formControlName="height">
                    <mat-option [value]="1080">
                      Definição Full HD (1080p)
                    </mat-option>
                    <mat-option [value]="720">
                      Alta definição (720p)
                    </mat-option>
                    <mat-option [value]="480">
                      Definição padrão (480p)
                    </mat-option>
                    <mat-option [value]="360">
                      Baixa definição (360p)
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </section>

              <section formGroupName="audio">
                <mat-checkbox formControlName="echoCancellation">
                  Cancelamento de eco
                </mat-checkbox>
              </section>
            </mat-card-content>
          </ng-template>
        </mat-tab>
      </mat-tab-group> -->

      <footer class="flex row justify-end">
        <a mat-raised-button routerLink="../meet" color="accent"> Continuar </a>
      </footer>
    </div>

    <ng-container *ngIf="facade.stream$ | async as stream">
      <canvas [speekAudioFrequency]="stream" [opacity]="0.12"></canvas>
    </ng-container>
  </mat-card>
</form>
